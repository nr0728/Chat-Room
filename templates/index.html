<!DOCTYPE html>
<html lang="en">
<head>
    <style>
        #language-selector{
            background-color: #8CC269;
            color: white;
            border: none;
            cursor: pointer;
            border-radius: 0 4px 4px 0;
            padding: 10px 2.5px;
            text-decoration: none;
            font-size: 16px;
            transition: background-color 0.3s ease, box-shadow 0.3s ease;
            box-shadow: 0px 0px 10px rgba(0, 0, 0, 0.3);
        }
    </style>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>èŠå¤©å®¤</title>
    <link rel="stylesheet" type="text/css" href="{{ url_for('static', filename='styles.css') }}">
    <link rel="stylesheet" type="text/css" href="{{ url_for('static', filename='prism.css') }}">
    <script src="{{ url_for('static', filename='socket.io.min.js') }}"></script>
	<link href="{{ url_for('static', filename='sweetalert2.all.min.js') }}" rel="stylesheet"></link>
</head>
<body>
	<input type="text" style="display:none">
    <h1>èŠå¤©å®¤</h1>
    <div id="nav-buttons">
        <button onclick="showRegisterForm()" id="register-button">æ³¨å†Œ</button>
        <button onclick="showLoginForm()" id="login-button">ç™»å½•</button>    
        <button onclick="window.location.href='/panel'" id="panel-button" style="display:none;">æ§åˆ¶é¢æ¿</button>
    </div>

    <div id="chat-container">
        <div id="chat-history">
        </div>
        <div id="input-container">
    <input type="text" id="message-input" placeholder="è¾“å…¥ä½ çš„æ¶ˆæ¯â€¦" style="height:60px;" autocomplete="off" readonly onfocus="this.removeAttribute('readonly');">
    <!-- &nbsp;&nbsp;
    <button onclick="startVoiceInput()" style="height:60px;padding:10px;">ğŸ¤ è¯­éŸ³è¾“å…¥</button>
    &nbsp;&nbsp;
    <select id="language-selector" style="height:60px;background-color: #8CC269;">
    <option value="zh-CN">ä¸­æ–‡</option>
    <option value="en-US">English</option>
    <option value="es-ES">EspaÃ±ol</option>
    <option value="fr-FR">FranÃ§ais</option>
    <option value="de-DE">Deutsch</option>
    <option value="ja-JP">æ—¥æœ¬èª</option>
    <option value="ko-KR">í•œêµ­ì–´</option>
    <option value="it-IT">Italiano</option>
    <option value="pt-BR">PortuguÃªs (Brasil)</option>
    <option value="ru-RU">Ğ ÑƒÑÑĞºĞ¸Ğ¹</option>
    <option value="ar-SA">Ø§Ù„Ø¹Ø±Ø¨ÙŠØ©</option>
    <option value="hi-IN">à¤¹à¤¿à¤¨à¥à¤¦à¥€</option>
</select> -->
    &nbsp;&nbsp;
    <button onclick="openEmojiPicker()" style="height:60px;padding:10px;">ğŸ˜€ æ’å…¥ Emoji</button>
    &nbsp;&nbsp;
    <button onclick="sendMessage()" style="height:60px;">ğŸ“© å‘é€æ¶ˆæ¯</button>
</div>
        <div id="input-container-code">
            <textarea type="text" id="message-input-code" class="swal-content__textarea" placeholder=" è¾“å…¥ä½ çš„ä»£ç â€¦" rows="2" autocomplete="off"></textarea>
            &nbsp;&nbsp;
            <button onclick="openEmojiPickerCode()" style="height:60px;padding:10px;">ğŸ˜€ æ’å…¥ Emoji</button>
            &nbsp;&nbsp;
            <button onclick="sendCode()">ğŸ“© å‘é€ä»£ç </button>
        </div>
    </div>

    <div id="register-form" class="modal">
        <div class="modal-content">
            <span class="close" onclick="closeRegisterForm()">&times;</span>
            <h2>æ³¨å†Œ</h2>
            <input type="text" id="register-username" placeholder="ç”¨æˆ·å">
            <input type="password" id="register-password" placeholder="å¯†ç ">
            <input type="password" id="register-confirm-password" placeholder="ç¡®è®¤å¯†ç ">
            <input type="text" id="register-captcha" placeholder="éªŒè¯ç ">
            <img id="captcha-image-reg" src="#" alt="éªŒè¯ç " onclick="reloadCode(2);">
            <p>æ³¨ï¼šè¯·åœ¨æ³¨å†Œåç™»å½•ã€‚</p>
            <button onclick="register()">æ³¨å†Œ</button>
        </div>
    </div>

    <div id="login-form" class="modal">
        <div class="modal-content">
            <span class="close" onclick="closeLoginForm()">&times;</span>
            <h2>ç™»å½•</h2>
            <input type="text" id="login-username" placeholder="ç”¨æˆ·å">
            <input type="password" id="login-password" placeholder="å¯†ç ">
            <input type="text" id="login-captcha" placeholder="éªŒè¯ç ">
            <img id="captcha-image-log" src="#" alt="éªŒè¯ç " onclick="reloadCode(1);">
            <button onclick="login()">ç™»å½•</button>
            <button onclick="loginWithLoginkey()">ä½¿ç”¨ Loginkey ç™»å½•</button>
        </div>
    </div>

    <div id="notification" class="notification"></div>


    <script>
// æ£€æŸ¥ç”¨æˆ·æ˜¯å¦ä¸ºç®¡ç†å‘˜
fetch('user_status', {
    method: 'POST',
    headers: {
        'Content-Type': 'application/x-www-form-urlencoded',
    },
    body: ``
})
.then(response => response.json())
.then(data => {
    if (data.status === 'OK' && data.message.includes('ç®¡ç†å‘˜')) {
        document.getElementById('panel-button').style.display = 'inline-block';
    }
});

        let usingUsername = 'æœªç™»å½•ï¼Œè¯·å…ˆç™»å½• ã€‚'
        const socket = io();

        socket.on('new_message', (data) => {
			updateChatHistory();
	    });

		fetch('user_status', {
			method: 'POST',
			headers: {
				'Content-Type': 'application/x-www-form-urlencoded',
			},
			body: ``
		})
		.then(response => response.json())
		.then(data => {
			if (data.status === 'OK') {
				document.getElementById('register-button').innerText="æ‚¨å·²ç™»å½•";
				document.getElementById('login-button').innerText="ç™»å‡º";
				showNotification('æ‚¨æ­£ä»¥ '+data.message+' çš„èº«ä»½èŠå¤©ã€‚', 'ok');
                usingUsername = data.message;
				updateChatHistory();
			} else {
				showNotification('ç³»ç»Ÿæ¶ˆæ¯ï¼šç™»å½•åæ‰å¯å‘é€æ¶ˆæ¯ã€‚', 'fail');
			}
		});
        function reloadCode(CodingOIer) {
            if (CodingOIer == 2) document.getElementById('captcha-image-reg').src="/captcha?"+String(Math.random(1,1145141919810));
            else document.getElementById('captcha-image-log').src="/captcha?"+String(Math.random(1,1145141919810));
		}
		function showUserInformation(uname) {
			fetch('/user_status', {
				method: 'POST',
				headers: {
					'Content-Type': 'application/x-www-form-urlencoded',
				},
			})
			.then(response => response.json())
			.then(data => {
				if (data.status === 'OK') {
					Swal.fire({
						imageUrl: "https://cdn.luogu.com.cn/images/icon.png",
						title: uname,
						imageHeight: 96,
						showCancelButton: true,
						confirmButtonText: data.is_2fa_enabled ? 'å…³é—­ 2FA' : 'å¯ç”¨ 2FA',
						cancelButtonText: 'å…³é—­',
						footer: '<button onclick="openLoginkeyRegistration()">æ³¨å†Œ Loginkey</button>'
					}).then((result) => {
						if (result.isConfirmed) {
							if (data.is_2fa_enabled) {
								// éªŒè¯ 2FA åå…³é—­
								Swal.fire({
									title: 'éªŒè¯ 2FA',
									input: 'text',
									inputLabel: 'è¯·è¾“å…¥æ‚¨çš„ 2FA éªŒè¯ç ',
									inputPlaceholder: '6 ä½æ•°å­—éªŒè¯ç ',
									showCancelButton: true,
									confirmButtonText: 'éªŒè¯å¹¶å…³é—­ 2FA',
									cancelButtonText: 'å–æ¶ˆ',
								}).then((verifyResult) => {
									if (verifyResult.isConfirmed) {
										const code = verifyResult.value.trim();
										if (!code) {
											Swal.fire({
												title: 'é”™è¯¯',
												text: 'éªŒè¯ç ä¸èƒ½ä¸ºç©º',
												icon: 'error',
											});
											return;
										}

										fetch('/disable_2fa', {
											method: 'POST',
											headers: {
												'Content-Type': 'application/x-www-form-urlencoded',
											},
											body: `code=${encodeURIComponent(code)}`,
										})
										.then(response => response.json())
										.then(data => {
											if (data.status === 'OK') {
												Swal.fire({
													title: '2FA å·²ç¦ç”¨',
													text: 'æ‚¨å·²æˆåŠŸå…³é—­ 2FA',
													icon: 'success',
												});
											} else {
												Swal.fire({
													title: 'é”™è¯¯',
													text: data.message,
													icon: 'error',
												});
											}
										})
										.catch(error => {
											Swal.fire({
												title: 'é”™è¯¯',
												text: 'ç¦ç”¨ 2FA æ—¶å‡ºç°é—®é¢˜',
												icon: 'error',
											});
										});
									}
								});
							} else {
								fetch('/enable_2fa', {
								method: 'POST',
								headers: {
									'Content-Type': 'application/x-www-form-urlencoded',
								},
							})
							.then(response => {
								if (response.ok) {
									return response.json(); // è¿”å› JSON æ•°æ®ï¼ŒåŒ…æ‹¬äºŒç»´ç å’Œå¯†é’¥
								} else {
									throw new Error('å¯ç”¨ 2FA å¤±è´¥');
								}
							})
							.then(data => {
								const qrUrl = data.qr_url; // äºŒç»´ç  URL
								const secretKey = data.secret_key; // 2FA å¯†é’¥
								Swal.fire({
									title: 'æ‰«æäºŒç»´ç ä»¥å¯ç”¨ 2FA',
									html: `
										<p>è¯·ä½¿ç”¨ Google Authenticator æˆ–å…¶ä»– TOTP åº”ç”¨æ‰«æä»¥ä¸‹äºŒç»´ç ã€‚</p>
										<img src="${qrUrl}" style="width: 200px; height: 200px;" />
										<p>æˆ–è€…æ‰‹åŠ¨è¾“å…¥ä»¥ä¸‹å¯†é’¥ï¼š</p>
										<p style="font-family: Consolas; font-size: 16px; color: #333;">${secretKey}</p>
									`,
									confirmButtonText: 'å®Œæˆ',
									cancelButtonText: 'å–æ¶ˆ',
									showCancelButton: true,
								}).then((qrResult) => {
									if (qrResult.isConfirmed) {
										verify2FAForEnable();
									} else {
										Swal.fire({
											title: 'æ“ä½œå–æ¶ˆ',
											text: '2FA æœªå¯ç”¨',
											icon: 'info',
										});
									}
								});
							})
							.catch(error => {
								Swal.fire({
									title: 'é”™è¯¯',
									text: error.message,
									icon: 'error',
								});
							});
							}
						}
					});
				} else {
					Swal.fire({
						title: 'é”™è¯¯',
						text: 'æ— æ³•è·å–ç”¨æˆ·çŠ¶æ€',
						icon: 'error',
					});
				}
			})
			.catch(error => {
				Swal.fire({
					title: 'é”™è¯¯',
					text: 'è¯·æ±‚å¤±è´¥ï¼Œè¯·ç¨åé‡è¯•',
					icon: 'error',
				});
			});
		}		
        //         function startVoiceInput() {
        //     if (!('webkitSpeechRecognition' in window)) {
        //         Swal.fire({
        //             title: 'é”™è¯¯',
        //             text: 'æ‚¨çš„æµè§ˆå™¨ä¸æ”¯æŒè¯­éŸ³è¾“å…¥åŠŸèƒ½ã€‚',
        //             icon: 'error',
        //         });
        //         return;
        //     }
        
        //     const recognition = new webkitSpeechRecognition();
        //     const selectedLanguage = document.getElementById('language-selector').value; // è·å–ç”¨æˆ·é€‰æ‹©çš„è¯­è¨€
        //     recognition.lang = selectedLanguage; // è®¾ç½®è¯­è¨€
        //     recognition.interimResults = false;
        //     recognition.maxAlternatives = 1;
        
        //     Swal.fire({
        //         title: 'æ­£åœ¨ç›‘å¬...',
        //         html: 'è¯·å¼€å§‹è¯´è¯...',
        //         allowOutsideClick: false,
        //         showCancelButton: true,
        //         cancelButtonText: 'å–æ¶ˆ',
        //         didOpen: () => {
        //             recognition.start();
        //         },
        //     });
        
        //     recognition.onresult = (event) => {
        //         const transcript = event.results[0][0].transcript;
        //         document.getElementById('message-input').value += transcript;
        //         Swal.close();
        //     };
        
        //     recognition.onerror = (event) => {
        //         Swal.fire({
        //             title: 'é”™è¯¯',
        //             text: 'è¯­éŸ³è¯†åˆ«å¤±è´¥ï¼Œè¯·é‡è¯•ã€‚',
        //             icon: 'error',
        //         });
        //     };
        // }
		function openLoginkeyRegistration() {
    fetch('/user_status', {
        method: 'POST',
        headers: {
            'Content-Type': 'application/x-www-form-urlencoded',
        },
        body: ``
    })
    .then(response => response.json())
    .then(data => {
        if (data.status === 'OK') {
            if (data.is_2fa_enabled) {
                // å¦‚æœå¯ç”¨äº† 2FAï¼Œå¼¹å‡º 2FA éªŒè¯çª—å£
                Swal.fire({
                    title: 'æ³¨å†Œ Loginkey',
                    input: 'text',
                    inputLabel: 'è¯·è¾“å…¥ 2FA éªŒè¯ç ',
                    inputPlaceholder: '6 ä½æ•°å­—éªŒè¯ç ',
                    showCancelButton: true,
                    confirmButtonText: 'éªŒè¯å¹¶æ³¨å†Œ',
                    cancelButtonText: 'å–æ¶ˆ',
                }).then((result) => {
                    if (result.isConfirmed) {
                        const code = result.value.trim();
                        if (!code) {
                            Swal.fire({
                                title: 'é”™è¯¯',
                                text: 'éªŒè¯ç ä¸èƒ½ä¸ºç©º',
                                icon: 'error',
                            });
                            return;
                        }
                        // æäº¤ 2FA éªŒè¯ç å’Œæ³¨å†Œè¯·æ±‚
                        fetch('/register_loginkey', {
                            method: 'POST',
                            headers: {
                                'Content-Type': 'application/x-www-form-urlencoded',
                            },
                            body: `code=${encodeURIComponent(code)}`
                        })
                        .then(response => response.json())
                        .then(data => {
                            if (data.status === 'OK') {
                                Swal.fire({
                                    title: 'æ³¨å†ŒæˆåŠŸ',
                                    text: `è¯·å¦¥å–„ä¿å­˜æ‚¨çš„ Loginkeyï¼š${data.loginkey}`,
                                    icon: 'success',
                                });
                            } else {
                                Swal.fire({
                                    title: 'æ³¨å†Œå¤±è´¥',
                                    text: data.message,
                                    icon: 'error',
                                });
                            }
                        });
                    }
                });
            } else {
                // å¦‚æœæœªå¯ç”¨ 2FAï¼Œç›´æ¥æ³¨å†Œ Loginkey
                fetch('/register_loginkey', {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/x-www-form-urlencoded',
                    },
                    body: ``
                })
                .then(response => response.json())
                .then(data => {
                    if (data.status === 'OK') {
                        Swal.fire({
                            title: 'æ³¨å†ŒæˆåŠŸ',
                            text: `è¯·å¦¥å–„ä¿å­˜æ‚¨çš„ Loginkeyï¼š${data.loginkey}`,
                            icon: 'success',
                        });
                    } else {
                        Swal.fire({
                            title: 'æ³¨å†Œå¤±è´¥',
                            text: data.message,
                            icon: 'error',
                        });
                    }
                });
            }
        } else {
            Swal.fire({
                title: 'é”™è¯¯',
                text: 'è¯·å…ˆç™»å½•åå†æ³¨å†Œ Loginkeyã€‚',
                icon: 'error',
            });
        }
    });
}
		function verify2FAForEnable() {
			Swal.fire({
				title: 'éªŒè¯ 2FA',
				input: 'text',
				inputLabel: 'è¯·è¾“å…¥æ‚¨çš„ 2FA éªŒè¯ç ',
				inputPlaceholder: '6 ä½æ•°å­—éªŒè¯ç ',
				showCancelButton: true,
				confirmButtonText: 'éªŒè¯',
				cancelButtonText: 'å–æ¶ˆ',
			}).then((result) => {
				if (result.isConfirmed) {
					const code = result.value.trim();
					if (!code) {
						Swal.fire({
							title: 'é”™è¯¯',
							text: 'éªŒè¯ç ä¸èƒ½ä¸ºç©º',
							icon: 'error',
						});
						return;
					}

					fetch('/verify_2fa', {
						method: 'POST',
						headers: {
							'Content-Type': 'application/x-www-form-urlencoded',
						},
						body: `code=${encodeURIComponent(code)}`,
					})
					.then(response => response.json())
					.then(data => {
						if (data.status === 'OK') {
							Swal.fire({
								title: 'éªŒè¯æˆåŠŸ',
								text: '2FA å·²æˆåŠŸå¯ç”¨',
								icon: 'success',
							});
						} else {
							Swal.fire({
								title: 'éªŒè¯å¤±è´¥',
								text: data.message,
								icon: 'error',
							});
						}
					})
					.catch(error => {
						Swal.fire({
							title: 'é”™è¯¯',
							text: 'éªŒè¯è¿‡ç¨‹ä¸­å‡ºç°é—®é¢˜',
							icon: 'error',
						});
					});
				} else {
					Swal.fire({
						title: 'æ“ä½œå–æ¶ˆ',
						text: '2FA æœªå¯ç”¨',
						icon: 'info',
					});
				}
			});
		}

		function verify2FA() {
			Swal.fire({
				title: 'éªŒè¯ 2FA',
				input: 'text',
				inputLabel: 'è¯·è¾“å…¥æ‚¨çš„ 2FA éªŒè¯ç ',
				inputPlaceholder: '6 ä½æ•°å­—éªŒè¯ç ',
				showCancelButton: true,
				confirmButtonText: 'éªŒè¯',
				cancelButtonText: 'å–æ¶ˆ',
			}).then((result) => {
				if (result.isConfirmed) {
					const code = result.value.trim();
					if (!code) {
						Swal.fire({
							title: 'é”™è¯¯',
							text: 'éªŒè¯ç ä¸èƒ½ä¸ºç©º',
							icon: 'error',
						});
						return;
					}

					fetch('/verify_2fa', {
						method: 'POST',
						headers: {
							'Content-Type': 'application/x-www-form-urlencoded',
						},
						body: `code=${encodeURIComponent(code)}`,
					})
					.then(response => response.json())
					.then(data => {
						if (data.status === 'OK') {
							Swal.fire({
								title: 'éªŒè¯æˆåŠŸ',
								text: 'æ‚¨çš„ 2FA éªŒè¯å·²å®Œæˆ',
								icon: 'success',
							});
							return true;
						} else {
							Swal.fire({
								title: 'éªŒè¯å¤±è´¥',
								text: data.message,
								icon: 'error',
							});
						}
					})
					.catch(error => {
						Swal.fire({
							title: 'é”™è¯¯',
							text: 'éªŒè¯è¿‡ç¨‹ä¸­å‡ºç°é—®é¢˜',
							icon: 'error',
						});
					});
				}
			});
		}
        function showNotification(message, status, willAutomaticallyRefresh) {
			if (status == 'ok')
			{
				let timerInterval;
				Swal.fire({
					title: message,
                    icon: "success",
					html: "ç³»ç»Ÿæ¶ˆæ¯ï¼Œå°†åœ¨ <b></b> æ¯«ç§’åè‡ªåŠ¨å…³é—­ã€‚",
					timer: 1000,
					timerProgressBar: true,
					didOpen: () => {
						const timer = Swal.getPopup().querySelector("b");
						timerInterval = setInterval(() => {
							timer.textContent = `${Swal.getTimerLeft()}`;
						}, 10);
					},
					willClose: () => {
						clearInterval(timerInterval);
					}
				}).then((result) => {
					if (result.dismiss === Swal.DismissReason.timer) {
						console.log("success");
					}
				});
			}
			else
			{
				let timerInterval;
				Swal.fire({
					title: message,
                    icon: "error",
					html: "ç³»ç»Ÿæ¶ˆæ¯ï¼Œå°†åœ¨ <b></b> æ¯«ç§’åè‡ªåŠ¨å…³é—­ã€‚",
					timer: 1000,
					timerProgressBar: true,
					didOpen: () => {
						const timer = Swal.getPopup().querySelector("b");
						timerInterval = setInterval(() => {
							timer.textContent = `${Swal.getTimerLeft()}`;
						}, 10);
					},
					willClose: () => {
						clearInterval(timerInterval);
					}
				}).then((result) => {
					if (result.dismiss === Swal.DismissReason.timer) {
						console.log("success");
					}
				});
			}
			if (willAutomaticallyRefresh == 1) location.reload();
        }

        function showRegisterForm() {
			fetch('/user_status', {
				method: 'POST',
				headers: {
					'Content-Type': 'application/x-www-form-urlencoded',
				},
				body: ``
			})
			.then(response => response.json())
			.then(data => {
				if (data.status === 'OK') {
                	showUserInformation(data.message);
				} else {
            		document.getElementById('register-form').style.display = 'block';
		            document.getElementById('captcha-image-reg').src = '/captcha?'+String(Math.random(1,1145141919810));
				}
			});
        }

        function closeRegisterForm() {
            document.getElementById('register-form').style.display = 'none';
        }

        function showLoginForm() {
			fetch('/user_status', {
				method: 'POST',
				headers: {
					'Content-Type': 'application/x-www-form-urlencoded',
				},
				body: ``
			})
			.then(response => response.json())
			.then(data => {
				if (data.status === 'OK') {
					document.getElementById('login-button').innerText="ç™»å½•";
					document.getElementById('register-button').innerText="æ³¨å†Œ";
					showNotification('æ‚¨å·²ä»ç”¨æˆ· '+data.message+' ç™»å‡ºã€‚', 'ok');
					fetch('/logout', {
						method: 'POST',
						headers: {
							'Content-Type': 'application/x-www-form-urlencoded',
						},
						body: ``
					});
					updateChatHistory();
                    document.getElementById('panel-button').style.display = 'none';
				} else {
            		document.getElementById('login-form').style.display = 'block';
		            document.getElementById('captcha-image-log').src = '/captcha?'+String(Math.random(1,1145141919810));
					document.getElementById('panel-button').style.display = 'none';
				}
			});
        }

        function closeLoginForm() {
            document.getElementById('login-form').style.display = 'none';
        }

        function updateChatHistory() {
            fetch('/get_chat_history')
            .then(response => response.json())
            .then(data => {
                const chatHistoryDiv = document.getElementById('chat-history');
                chatHistoryDiv.innerHTML = '';
                const p = document.createElement('p');
                p.innerHTML = `<strong><font size="5">æˆ‘ä»¬çš„æ–°åŸŸåï¼š<a href="${window.location.href}">${window.location.href}</a><br>Our New Domain: <a href="${window.location.href}">${window.location.href}</a></font></strong>`;
                chatHistoryDiv.appendChild(p);
                data.reverse().forEach(entry => {
                    appendMessageToChatHistory(entry.timestamp, entry.username, entry.message);
                });
				/*Prism.highlightAll();*/
            });
        }

        function appendMessageToChatHistory(timestamp, username, message) {
            const chatHistoryDiv = document.getElementById('chat-history');
            const hr = document.createElement('hr');
            chatHistoryDiv.appendChild(hr);
            const p = document.createElement('p');
            p.innerHTML = `ç”¨æˆ· ${username} è¯´é“ï¼š${message}`;
            chatHistoryDiv.appendChild(p);
            const t = document.createElement('p');
            t.innerHTML = `${timestamp}`;
            t.style = `text-align:right;color:#999`;
            chatHistoryDiv.appendChild(t);
			/*Prism.highlightAll();*/
        }

        function updateChatHistoryWithNewMessage(data) {
            appendMessageToChatHistory(data.timestamp, data.username, data.message);
        }

        function sendMessage() {
            const messageInput = document.getElementById('message-input');
            const message = messageInput.value.trim();

            fetch('/send_message', {
                method: 'POST',
                headers: {
                    'Content-Type': 'application/x-www-form-urlencoded',
                },
                body: `message=${encodeURIComponent(message)}`
            })
            .then(response => response.json())
            .then(data => {
                if (data.status === 'OK') {
                    messageInput.value = '';
                } else {
                    showNotification(data.message, 'fail');
                }
            });
        }


        function sendCode() {
            const messageInput = document.getElementById('message-input-code');
            const message = messageInput.value.trim();

            fetch('/send_code', {
                method: 'POST',
                headers: {
                    'Content-Type': 'application/x-www-form-urlencoded',
                },
                body: `message=${encodeURIComponent(message)}`
            })
            .then(response => response.json())
            .then(data => {
                if (data.status === 'OK') {
                    messageInput.value = '';
                } else {
                    showNotification(data.message, 'fail');
                }
            });
        }

        document.getElementById('message-input').addEventListener('keyup', function(event) {
            if (event.key === 'Enter') {
                sendMessage();
            }
        });
        // åˆå§‹åŒ–åŠ è½½èŠå¤©è®°å½•
        updateChatHistory();

function register() {
            const username = document.getElementById('register-username').value.trim();
            const password = document.getElementById('register-password').value.trim();
            const confirmPassword = document.getElementById('register-confirm-password').value.trim();
            const captcha = document.getElementById('register-captcha').value.trim();

            if (password !== confirmPassword) {
                showNotification('å¯†ç ä¸åŒ¹é…', 'fail');
				reloadCode(2);
                return;
            }

            fetch('/register', {
                method: 'POST',
                headers: {
                    'Content-Type': 'application/x-www-form-urlencoded',
                },
                body: `username=${encodeURIComponent(username)}&password=${encodeURIComponent(password)}&captcha=${encodeURIComponent(captcha)}`
            })
            .then(response => response.json())
            .then(data => {
                if (data.status === 'OK') {
                    showNotification('æ³¨å†ŒæˆåŠŸ', 'ok', 1);
                    closeRegisterForm();
                } else {
					reloadCode(2);
                    showNotification(data.message, 'fail');
                }
            });
        }

        function login() {
            const username = document.getElementById('login-username').value.trim();
            const password = document.getElementById('login-password').value.trim();
            const captcha = document.getElementById('login-captcha').value.trim();

            fetch('/login', {
                method: 'POST',
                headers: {
                    'Content-Type': 'application/x-www-form-urlencoded',
                },
                body: `username=${encodeURIComponent(username)}&password=${encodeURIComponent(password)}&captcha=${encodeURIComponent(captcha)}`
            })
            .then(response => response.json())
            .then(data => {
                if (data.status === 'OK') {
                    showNotification('ç™»å½•æˆåŠŸ', 'ok', 1);
                    closeLoginForm();
                } else if (data.status === '2FA_REQUIRED') {
                    // å¦‚æœéœ€è¦ 2FA éªŒè¯
                    verify2FAAfterLogin();
                } else {
                    reloadCode(1);
                    showNotification(data.message, 'fail');
                }
            });
        }

        function verify2FAAfterLogin() {
            Swal.fire({
                title: 'éªŒè¯ 2FA',
                input: 'text',
                inputLabel: 'è¯·è¾“å…¥æ‚¨çš„ 2FA éªŒè¯ç ',
                inputPlaceholder: '6 ä½æ•°å­—éªŒè¯ç ',
                showCancelButton: true,
                confirmButtonText: 'éªŒè¯',
                cancelButtonText: 'å–æ¶ˆ',
            }).then((result) => {
                if (result.isConfirmed) {
                    const code = result.value.trim();
                    if (!code) {
                        Swal.fire({
                            title: 'é”™è¯¯',
                            text: 'éªŒè¯ç ä¸èƒ½ä¸ºç©º',
                            icon: 'error',
                        });
                        return;
                    }

                    fetch('/verify_2fa', {
                        method: 'POST',
                        headers: {
                            'Content-Type': 'application/x-www-form-urlencoded',
                        },
                        body: `code=${encodeURIComponent(code)}`,
                    })
                    .then(response => response.json())
                    .then(data => {
                        if (data.status === 'OK') {
                            Swal.fire({
                                title: 'éªŒè¯æˆåŠŸ',
                                text: 'æ‚¨çš„ 2FA éªŒè¯å·²å®Œæˆ',
                                icon: 'success',
                            }).then(() => {
                                showNotification('ç™»å½•æˆåŠŸ', 'ok', 1);
                                closeLoginForm();
                            });
                        } else {
                            Swal.fire({
                                title: 'éªŒè¯å¤±è´¥',
                                text: data.message,
                                icon: 'error',
                            });
                        }
                    })
                    .catch(error => {
                        Swal.fire({
                            title: 'é”™è¯¯',
                            text: 'éªŒè¯è¿‡ç¨‹ä¸­å‡ºç°é—®é¢˜',
                            icon: 'error',
                        });
                    });
                }
            });
        }

        function loginWithLoginkey() {
    Swal.fire({
        title: 'ä½¿ç”¨ Loginkey ç™»å½•',
        html: `
            <input type="text" id="swal-loginkey" class="swal2-input" placeholder="Loginkey">
        `,
        confirmButtonText: 'ç™»å½•',
        cancelButtonText: 'å–æ¶ˆ',
        showCancelButton: true,
        preConfirm: () => {
            const loginkey = document.getElementById('swal-loginkey').value.trim();
            if (!loginkey) {
                Swal.showValidationMessage('Loginkey ä¸èƒ½ä¸ºç©º');
                return false;
            }
            return loginkey;
        }
    }).then((result) => {
        if (result.isConfirmed) {
            const loginkey = result.value;
            fetch('/login_with_loginkey', {
                method: 'POST',
                headers: {
                    'Content-Type': 'application/x-www-form-urlencoded',
                },
                body: `loginkey=${encodeURIComponent(loginkey)}`
            })
            .then(response => response.json())
            .then(data => {
                if (data.status === 'OK') {
                    Swal.fire({
                        title: 'ç™»å½•æˆåŠŸ',
                        icon: 'success',
                    }).then(() => {
                        location.reload();
                    });
                } else {
                    Swal.fire({
                        title: 'ç™»å½•å¤±è´¥',
                        text: data.message,
                        icon: 'error',
                    });
                }
            })
            .catch(error => {
                Swal.fire({
                    title: 'é”™è¯¯',
                    text: 'ç™»å½•è¿‡ç¨‹ä¸­å‡ºç°é—®é¢˜ï¼Œè¯·ç¨åé‡è¯•ã€‚',
                    icon: 'error',
                });
            });
        }
    });
}
function openEmojiPicker() {
    const emojis = [
        'ğŸ˜€', 'ğŸ˜', 'ğŸ˜‚', 'ğŸ¤£', 'ğŸ˜ƒ', 'ğŸ˜„', 'ğŸ˜…', 'ğŸ˜†', 'ğŸ˜‰', 'ğŸ˜Š', 'ğŸ˜‹', 'ğŸ˜', 'ğŸ˜', 'ğŸ˜˜', 'ğŸ˜—', 'ğŸ˜™', 'ğŸ˜š', 'ğŸ™‚', 'ğŸ¤—', 'ğŸ¤”',
        'ğŸ˜', 'ğŸ˜‘', 'ğŸ˜¶', 'ğŸ™„', 'ğŸ˜', 'ğŸ˜£', 'ğŸ˜¥', 'ğŸ˜®', 'ğŸ¤', 'ğŸ˜¯', 'ğŸ˜ª', 'ğŸ˜«', 'ğŸ˜´', 'ğŸ˜Œ', 'ğŸ˜›', 'ğŸ˜œ', 'ğŸ˜', 'ğŸ¤¤', 'ğŸ˜’', 'ğŸ˜“',
        'ğŸ˜”', 'ğŸ˜•', 'ğŸ™ƒ', 'ğŸ¤‘', 'ğŸ˜²', 'â˜¹ï¸', 'ğŸ™', 'ğŸ˜–', 'ğŸ˜', 'ğŸ˜Ÿ', 'ğŸ˜¤', 'ğŸ˜¢', 'ğŸ˜­', 'ğŸ˜¦', 'ğŸ˜§', 'ğŸ˜¨', 'ğŸ˜©', 'ğŸ¤¯', 'ğŸ˜¬', 'ğŸ˜°',
        'ğŸ˜±', 'ğŸ¥µ', 'ğŸ¥¶', 'ğŸ˜³', 'ğŸ¤ª', 'ğŸ˜µ', 'ğŸ˜¡', 'ğŸ˜ ', 'ğŸ¤¬', 'ğŸ˜·', 'ğŸ¤’', 'ğŸ¤•', 'ğŸ¤¢', 'ğŸ¤®', 'ğŸ¤§', 'ğŸ˜‡', 'ğŸ¥³', 'ğŸ¥º', 'ğŸ¤ ', 'ğŸ¤¡',
        'ğŸ¤¥', 'ğŸ¤«', 'ğŸ¤­', 'ğŸ§', 'ğŸ¤“', 'ğŸ˜ˆ', 'ğŸ‘¿', 'ğŸ‘¹', 'ğŸ‘º', 'ğŸ’€', 'â˜ ï¸', 'ğŸ‘»', 'ğŸ‘½', 'ğŸ‘¾', 'ğŸ¤–', 'ğŸ’©', 'ğŸ˜º', 'ğŸ˜¸', 'ğŸ˜¹', 'ğŸ˜»',
        'ğŸ˜¼', 'ğŸ˜½', 'ğŸ™€', 'ğŸ˜¿', 'ğŸ˜¾', 'ğŸ™ˆ', 'ğŸ™‰', 'ğŸ™Š', 'ğŸ’‹', 'ğŸ’Œ', 'ğŸ’˜', 'ğŸ’', 'ğŸ’–', 'ğŸ’—', 'ğŸ’“', 'ğŸ’', 'ğŸ’•', 'ğŸ’Ÿ', 'â£ï¸', 'ğŸ’”',
        'â¤ï¸', 'ğŸ§¡', 'ğŸ’›', 'ğŸ’š', 'ğŸ’™', 'ğŸ’œ', 'ğŸ¤', 'ğŸ–¤', 'ğŸ¤', 'ğŸ’¯', 'ğŸ’¢', 'ğŸ’¥', 'ğŸ’«', 'ğŸ’¦', 'ğŸ’¨', 'ğŸ•³ï¸', 'ğŸ’£', 'ğŸ’¬', 'ğŸ‘ï¸â€ğŸ—¨ï¸', 'ğŸ—¨ï¸',
        'ğŸ—¯ï¸', 'ğŸ’­', 'ğŸ’¤', 'ğŸ‘‹', 'ğŸ¤š', 'ğŸ–ï¸', 'âœ‹', 'ğŸ––', 'ğŸ‘Œ', 'ğŸ¤Œ', 'ğŸ¤', 'âœŒï¸', 'ğŸ¤', 'ğŸ¤Ÿ', 'ğŸ¤˜', 'ğŸ¤™', 'ğŸ‘ˆ', 'ğŸ‘‰', 'ğŸ‘†', 'ğŸ–•',
        'ğŸ‘‡', 'â˜ï¸', 'ğŸ‘', 'ğŸ‘', 'âœŠ', 'ğŸ‘Š', 'ğŸ¤›', 'ğŸ¤œ', 'ğŸ‘', 'ğŸ™Œ', 'ğŸ‘', 'ğŸ¤²', 'ğŸ¤', 'ğŸ™', 'âœï¸', 'ğŸ’…', 'ğŸ¤³', 'ğŸ’ª', 'ğŸ¦¾', 'ğŸ¦µ',
        'ğŸ¦¿', 'ğŸ¦¶', 'ğŸ‘£', 'ğŸ‘‚', 'ğŸ¦»', 'ğŸ‘ƒ', 'ğŸ§ ', 'ğŸ«€', 'ğŸ«', 'ğŸ¦·', 'ğŸ¦´', 'ğŸ‘€', 'ğŸ‘ï¸', 'ğŸ‘…', 'ğŸ‘„', 'ğŸ«¦', 'ğŸ‘¶', 'ğŸ§’', 'ğŸ‘¦', 'ğŸ‘§',
        'ğŸ§‘', 'ğŸ‘±', 'ğŸ‘¨', 'ğŸ§”', 'ğŸ§”â€â™‚ï¸', 'ğŸ§”â€â™€ï¸', 'ğŸ‘©', 'ğŸ§“', 'ğŸ‘´', 'ğŸ‘µ', 'ğŸ™', 'ğŸ™â€â™‚ï¸', 'ğŸ™â€â™€ï¸', 'ğŸ™', 'ğŸ™â€â™‚ï¸', 'ğŸ™â€â™€ï¸', 'ğŸ™…', 'ğŸ™…â€â™‚ï¸',
        'ğŸ™…â€â™€ï¸', 'ğŸ™†', 'ğŸ™†â€â™‚ï¸', 'ğŸ™†â€â™€ï¸', 'ğŸ’', 'ğŸ’â€â™‚ï¸', 'ğŸ’â€â™€ï¸', 'ğŸ™‹', 'ğŸ™‹â€â™‚ï¸', 'ğŸ™‹â€â™€ï¸', 'ğŸ§', 'ğŸ§â€â™‚ï¸', 'ğŸ§â€â™€ï¸', 'ğŸ™‡', 'ğŸ™‡â€â™‚ï¸', 'ğŸ™‡â€â™€ï¸',
        'ğŸ¤¦', 'ğŸ¤¦â€â™‚ï¸', 'ğŸ¤¦â€â™€ï¸', 'ğŸ¤·', 'ğŸ¤·â€â™‚ï¸', 'ğŸ¤·â€â™€ï¸', 'ğŸ§‘â€âš•ï¸', 'ğŸ‘¨â€âš•ï¸', 'ğŸ‘©â€âš•ï¸', 'ğŸ§‘â€ğŸ“', 'ğŸ‘¨â€ğŸ“', 'ğŸ‘©â€ğŸ“', 'ğŸ§‘â€ğŸ«', 'ğŸ‘¨â€ğŸ«', 'ğŸ‘©â€ğŸ«', 'ğŸ§‘â€âš–ï¸',
        'ğŸ‘¨â€âš–ï¸', 'ğŸ‘©â€âš–ï¸', 'ğŸ§‘â€ğŸŒ¾', 'ğŸ‘¨â€ğŸŒ¾', 'ğŸ‘©â€ğŸŒ¾', 'ğŸ§‘â€ğŸ³', 'ğŸ‘¨â€ğŸ³', 'ğŸ‘©â€ğŸ³', 'ğŸ§‘â€ğŸ”§', 'ğŸ‘¨â€ğŸ”§', 'ğŸ‘©â€ğŸ”§', 'ğŸ§‘â€ğŸ­', 'ğŸ‘¨â€ğŸ­', 'ğŸ‘©â€ğŸ­', 'ğŸ§‘â€ğŸ’¼', 'ğŸ‘¨â€ğŸ’¼',
        'ğŸ‘©â€ğŸ’¼', 'ğŸ§‘â€ğŸ”¬', 'ğŸ‘¨â€ğŸ”¬', 'ğŸ‘©â€ğŸ”¬', 'ğŸ§‘â€ğŸ’»', 'ğŸ‘¨â€ğŸ’»', 'ğŸ‘©â€ğŸ’»', 'ğŸ§‘â€ğŸ¤', 'ğŸ‘¨â€ğŸ¤', 'ğŸ‘©â€ğŸ¤', 'ğŸ§‘â€ğŸ¨', 'ğŸ‘¨â€ğŸ¨', 'ğŸ‘©â€ğŸ¨', 'ğŸ§‘â€âœˆï¸', 'ğŸ‘¨â€âœˆï¸', 'ğŸ‘©â€âœˆï¸',
        'ğŸ§‘â€ğŸš€', 'ğŸ‘¨â€ğŸš€', 'ğŸ‘©â€ğŸš€', 'ğŸ§‘â€ğŸš’', 'ğŸ‘¨â€ğŸš’', 'ğŸ‘©â€ğŸš’', 'ğŸ‘®', 'ğŸ‘®â€â™‚ï¸', 'ğŸ‘®â€â™€ï¸', 'ğŸ•µï¸', 'ğŸ•µï¸â€â™‚ï¸', 'ğŸ•µï¸â€â™€ï¸', 'ğŸ’‚', 'ğŸ’‚â€â™‚ï¸', 'ğŸ’‚â€â™€ï¸', 'ğŸ‘·', 'ğŸ‘·â€â™‚ï¸',
        'ğŸ‘·â€â™€ï¸', 'ğŸ¤´', 'ğŸ‘¸', 'ğŸ‘³', 'ğŸ‘³â€â™‚ï¸', 'ğŸ‘³â€â™€ï¸', 'ğŸ‘²', 'ğŸ§•', 'ğŸ¤µ', 'ğŸ¤µâ€â™‚ï¸', 'ğŸ¤µâ€â™€ï¸', 'ğŸ‘°', 'ğŸ‘°â€â™‚ï¸', 'ğŸ‘°â€â™€ï¸', 'ğŸ¤°', 'ğŸ¤±', 'ğŸ‘©â€ğŸ¼', 'ğŸ‘¨â€ğŸ¼', 'ğŸ§‘â€ğŸ¼',
        'ğŸ‘¼', 'ğŸ…', 'ğŸ¤¶', 'ğŸ§‘â€ğŸ„', 'ğŸ¦¸', 'ğŸ¦¸â€â™‚ï¸', 'ğŸ¦¸â€â™€ï¸', 'ğŸ¦¹', 'ğŸ¦¹â€â™‚ï¸', 'ğŸ¦¹â€â™€ï¸', 'ğŸ§™', 'ğŸ§™â€â™‚ï¸', 'ğŸ§™â€â™€ï¸', 'ğŸ§š', 'ğŸ§šâ€â™‚ï¸', 'ğŸ§šâ€â™€ï¸', 'ğŸ§›', 'ğŸ§›â€â™‚ï¸',
        'ğŸ§›â€â™€ï¸', 'ğŸ§œ', 'ğŸ§œâ€â™‚ï¸', 'ğŸ§œâ€â™€ï¸', 'ğŸ§', 'ğŸ§â€â™‚ï¸', 'ğŸ§â€â™€ï¸', 'ğŸ§', 'ğŸ§â€â™‚ï¸', 'ğŸ§â€â™€ï¸', 'ğŸ§Ÿ', 'ğŸ§Ÿâ€â™‚ï¸', 'ğŸ§Ÿâ€â™€ï¸', 'ğŸ§Œ', 'ğŸ’†', 'ğŸ’†â€â™‚ï¸', 'ğŸ’†â€â™€ï¸', 'ğŸ’‡',
        'ğŸ’‡â€â™‚ï¸', 'ğŸ’‡â€â™€ï¸', 'ğŸš¶', 'ğŸš¶â€â™‚ï¸', 'ğŸš¶â€â™€ï¸', 'ğŸ§', 'ğŸ§â€â™‚ï¸', 'ğŸ§â€â™€ï¸', 'ğŸ§', 'ğŸ§â€â™‚ï¸', 'ğŸ§â€â™€ï¸', 'ğŸ¦¯', 'ğŸ¦¼', 'ğŸ¦½', 'ğŸƒ', 'ğŸƒâ€â™‚ï¸', 'ğŸƒâ€â™€ï¸', 'ğŸ’ƒ',
        'ğŸ•º', 'ğŸ•´ï¸', 'ğŸ‘¯', 'ğŸ‘¯â€â™‚ï¸', 'ğŸ‘¯â€â™€ï¸', 'ğŸ§–', 'ğŸ§–â€â™‚ï¸', 'ğŸ§–â€â™€ï¸', 'ğŸ§˜', 'ğŸ§‘â€ğŸ¤â€ğŸ§‘', 'ğŸ‘­', 'ğŸ‘«', 'ğŸ‘¬', 'ğŸ’', 'ğŸ‘©â€â¤ï¸â€ğŸ’‹â€ğŸ‘¨'
    ];

    let emojiHtml = '';
    emojis.forEach(emoji => {
        emojiHtml += `<button class="emoji-button" onclick="addEmojiToInput('${emoji}')">${emoji}</button>`;
    });

    Swal.fire({
        title: 'é€‰æ‹©ä¸€ä¸ª Emoji',
        html: `<div style="display: flex; flex-wrap: wrap; gap: 8.4px;">${emojiHtml}</div>`,
        showConfirmButton: false,
        showCancelButton: true,
        cancelButtonText: 'å…³é—­',
    });
}

function addEmojiToInput(emoji) {
    const input = document.getElementById('message-input');
    input.value += emoji;
    Swal.close(); // å…³é—­ Emoji é€‰æ‹©å™¨
}

        function openEmojiPickerCode() {
            const emojis = [
        'ğŸ˜€', 'ğŸ˜', 'ğŸ˜‚', 'ğŸ¤£', 'ğŸ˜ƒ', 'ğŸ˜„', 'ğŸ˜…', 'ğŸ˜†', 'ğŸ˜‰', 'ğŸ˜Š', 'ğŸ˜‹', 'ğŸ˜', 'ğŸ˜', 'ğŸ˜˜', 'ğŸ˜—', 'ğŸ˜™', 'ğŸ˜š', 'ğŸ™‚', 'ğŸ¤—', 'ğŸ¤”',
        'ğŸ˜', 'ğŸ˜‘', 'ğŸ˜¶', 'ğŸ™„', 'ğŸ˜', 'ğŸ˜£', 'ğŸ˜¥', 'ğŸ˜®', 'ğŸ¤', 'ğŸ˜¯', 'ğŸ˜ª', 'ğŸ˜«', 'ğŸ˜´', 'ğŸ˜Œ', 'ğŸ˜›', 'ğŸ˜œ', 'ğŸ˜', 'ğŸ¤¤', 'ğŸ˜’', 'ğŸ˜“',
        'ğŸ˜”', 'ğŸ˜•', 'ğŸ™ƒ', 'ğŸ¤‘', 'ğŸ˜²', 'â˜¹ï¸', 'ğŸ™', 'ğŸ˜–', 'ğŸ˜', 'ğŸ˜Ÿ', 'ğŸ˜¤', 'ğŸ˜¢', 'ğŸ˜­', 'ğŸ˜¦', 'ğŸ˜§', 'ğŸ˜¨', 'ğŸ˜©', 'ğŸ¤¯', 'ğŸ˜¬', 'ğŸ˜°',
        'ğŸ˜±', 'ğŸ¥µ', 'ğŸ¥¶', 'ğŸ˜³', 'ğŸ¤ª', 'ğŸ˜µ', 'ğŸ˜¡', 'ğŸ˜ ', 'ğŸ¤¬', 'ğŸ˜·', 'ğŸ¤’', 'ğŸ¤•', 'ğŸ¤¢', 'ğŸ¤®', 'ğŸ¤§', 'ğŸ˜‡', 'ğŸ¥³', 'ğŸ¥º', 'ğŸ¤ ', 'ğŸ¤¡',
        'ğŸ¤¥', 'ğŸ¤«', 'ğŸ¤­', 'ğŸ§', 'ğŸ¤“', 'ğŸ˜ˆ', 'ğŸ‘¿', 'ğŸ‘¹', 'ğŸ‘º', 'ğŸ’€', 'â˜ ï¸', 'ğŸ‘»', 'ğŸ‘½', 'ğŸ‘¾', 'ğŸ¤–', 'ğŸ’©', 'ğŸ˜º', 'ğŸ˜¸', 'ğŸ˜¹', 'ğŸ˜»',
        'ğŸ˜¼', 'ğŸ˜½', 'ğŸ™€', 'ğŸ˜¿', 'ğŸ˜¾', 'ğŸ™ˆ', 'ğŸ™‰', 'ğŸ™Š', 'ğŸ’‹', 'ğŸ’Œ', 'ğŸ’˜', 'ğŸ’', 'ğŸ’–', 'ğŸ’—', 'ğŸ’“', 'ğŸ’', 'ğŸ’•', 'ğŸ’Ÿ', 'â£ï¸', 'ğŸ’”',
        'â¤ï¸', 'ğŸ§¡', 'ğŸ’›', 'ğŸ’š', 'ğŸ’™', 'ğŸ’œ', 'ğŸ¤', 'ğŸ–¤', 'ğŸ¤', 'ğŸ’¯', 'ğŸ’¢', 'ğŸ’¥', 'ğŸ’«', 'ğŸ’¦', 'ğŸ’¨', 'ğŸ•³ï¸', 'ğŸ’£', 'ğŸ’¬', 'ğŸ‘ï¸â€ğŸ—¨ï¸', 'ğŸ—¨ï¸',
        'ğŸ—¯ï¸', 'ğŸ’­', 'ğŸ’¤', 'ğŸ‘‹', 'ğŸ¤š', 'ğŸ–ï¸', 'âœ‹', 'ğŸ––', 'ğŸ‘Œ', 'ğŸ¤Œ', 'ğŸ¤', 'âœŒï¸', 'ğŸ¤', 'ğŸ¤Ÿ', 'ğŸ¤˜', 'ğŸ¤™', 'ğŸ‘ˆ', 'ğŸ‘‰', 'ğŸ‘†', 'ğŸ–•',
        'ğŸ‘‡', 'â˜ï¸', 'ğŸ‘', 'ğŸ‘', 'âœŠ', 'ğŸ‘Š', 'ğŸ¤›', 'ğŸ¤œ', 'ğŸ‘', 'ğŸ™Œ', 'ğŸ‘', 'ğŸ¤²', 'ğŸ¤', 'ğŸ™', 'âœï¸', 'ğŸ’…', 'ğŸ¤³', 'ğŸ’ª', 'ğŸ¦¾', 'ğŸ¦µ',
        'ğŸ¦¿', 'ğŸ¦¶', 'ğŸ‘£', 'ğŸ‘‚', 'ğŸ¦»', 'ğŸ‘ƒ', 'ğŸ§ ', 'ğŸ«€', 'ğŸ«', 'ğŸ¦·', 'ğŸ¦´', 'ğŸ‘€', 'ğŸ‘ï¸', 'ğŸ‘…', 'ğŸ‘„', 'ğŸ«¦', 'ğŸ‘¶', 'ğŸ§’', 'ğŸ‘¦', 'ğŸ‘§',
        'ğŸ§‘', 'ğŸ‘±', 'ğŸ‘¨', 'ğŸ§”', 'ğŸ§”â€â™‚ï¸', 'ğŸ§”â€â™€ï¸', 'ğŸ‘©', 'ğŸ§“', 'ğŸ‘´', 'ğŸ‘µ', 'ğŸ™', 'ğŸ™â€â™‚ï¸', 'ğŸ™â€â™€ï¸', 'ğŸ™', 'ğŸ™â€â™‚ï¸', 'ğŸ™â€â™€ï¸', 'ğŸ™…', 'ğŸ™…â€â™‚ï¸',
        'ğŸ™…â€â™€ï¸', 'ğŸ™†', 'ğŸ™†â€â™‚ï¸', 'ğŸ™†â€â™€ï¸', 'ğŸ’', 'ğŸ’â€â™‚ï¸', 'ğŸ’â€â™€ï¸', 'ğŸ™‹', 'ğŸ™‹â€â™‚ï¸', 'ğŸ™‹â€â™€ï¸', 'ğŸ§', 'ğŸ§â€â™‚ï¸', 'ğŸ§â€â™€ï¸', 'ğŸ™‡', 'ğŸ™‡â€â™‚ï¸', 'ğŸ™‡â€â™€ï¸',
        'ğŸ¤¦', 'ğŸ¤¦â€â™‚ï¸', 'ğŸ¤¦â€â™€ï¸', 'ğŸ¤·', 'ğŸ¤·â€â™‚ï¸', 'ğŸ¤·â€â™€ï¸', 'ğŸ§‘â€âš•ï¸', 'ğŸ‘¨â€âš•ï¸', 'ğŸ‘©â€âš•ï¸', 'ğŸ§‘â€ğŸ“', 'ğŸ‘¨â€ğŸ“', 'ğŸ‘©â€ğŸ“', 'ğŸ§‘â€ğŸ«', 'ğŸ‘¨â€ğŸ«', 'ğŸ‘©â€ğŸ«', 'ğŸ§‘â€âš–ï¸',
        'ğŸ‘¨â€âš–ï¸', 'ğŸ‘©â€âš–ï¸', 'ğŸ§‘â€ğŸŒ¾', 'ğŸ‘¨â€ğŸŒ¾', 'ğŸ‘©â€ğŸŒ¾', 'ğŸ§‘â€ğŸ³', 'ğŸ‘¨â€ğŸ³', 'ğŸ‘©â€ğŸ³', 'ğŸ§‘â€ğŸ”§', 'ğŸ‘¨â€ğŸ”§', 'ğŸ‘©â€ğŸ”§', 'ğŸ§‘â€ğŸ­', 'ğŸ‘¨â€ğŸ­', 'ğŸ‘©â€ğŸ­', 'ğŸ§‘â€ğŸ’¼', 'ğŸ‘¨â€ğŸ’¼',
        'ğŸ‘©â€ğŸ’¼', 'ğŸ§‘â€ğŸ”¬', 'ğŸ‘¨â€ğŸ”¬', 'ğŸ‘©â€ğŸ”¬', 'ğŸ§‘â€ğŸ’»', 'ğŸ‘¨â€ğŸ’»', 'ğŸ‘©â€ğŸ’»', 'ğŸ§‘â€ğŸ¤', 'ğŸ‘¨â€ğŸ¤', 'ğŸ‘©â€ğŸ¤', 'ğŸ§‘â€ğŸ¨', 'ğŸ‘¨â€ğŸ¨', 'ğŸ‘©â€ğŸ¨', 'ğŸ§‘â€âœˆï¸', 'ğŸ‘¨â€âœˆï¸', 'ğŸ‘©â€âœˆï¸',
        'ğŸ§‘â€ğŸš€', 'ğŸ‘¨â€ğŸš€', 'ğŸ‘©â€ğŸš€', 'ğŸ§‘â€ğŸš’', 'ğŸ‘¨â€ğŸš’', 'ğŸ‘©â€ğŸš’', 'ğŸ‘®', 'ğŸ‘®â€â™‚ï¸', 'ğŸ‘®â€â™€ï¸', 'ğŸ•µï¸', 'ğŸ•µï¸â€â™‚ï¸', 'ğŸ•µï¸â€â™€ï¸', 'ğŸ’‚', 'ğŸ’‚â€â™‚ï¸', 'ğŸ’‚â€â™€ï¸', 'ğŸ‘·', 'ğŸ‘·â€â™‚ï¸',
        'ğŸ‘·â€â™€ï¸', 'ğŸ¤´', 'ğŸ‘¸', 'ğŸ‘³', 'ğŸ‘³â€â™‚ï¸', 'ğŸ‘³â€â™€ï¸', 'ğŸ‘²', 'ğŸ§•', 'ğŸ¤µ', 'ğŸ¤µâ€â™‚ï¸', 'ğŸ¤µâ€â™€ï¸', 'ğŸ‘°', 'ğŸ‘°â€â™‚ï¸', 'ğŸ‘°â€â™€ï¸', 'ğŸ¤°', 'ğŸ¤±', 'ğŸ‘©â€ğŸ¼', 'ğŸ‘¨â€ğŸ¼', 'ğŸ§‘â€ğŸ¼',
        'ğŸ‘¼', 'ğŸ…', 'ğŸ¤¶', 'ğŸ§‘â€ğŸ„', 'ğŸ¦¸', 'ğŸ¦¸â€â™‚ï¸', 'ğŸ¦¸â€â™€ï¸', 'ğŸ¦¹', 'ğŸ¦¹â€â™‚ï¸', 'ğŸ¦¹â€â™€ï¸', 'ğŸ§™', 'ğŸ§™â€â™‚ï¸', 'ğŸ§™â€â™€ï¸', 'ğŸ§š', 'ğŸ§šâ€â™‚ï¸', 'ğŸ§šâ€â™€ï¸', 'ğŸ§›', 'ğŸ§›â€â™‚ï¸',
        'ğŸ§›â€â™€ï¸', 'ğŸ§œ', 'ğŸ§œâ€â™‚ï¸', 'ğŸ§œâ€â™€ï¸', 'ğŸ§', 'ğŸ§â€â™‚ï¸', 'ğŸ§â€â™€ï¸', 'ğŸ§', 'ğŸ§â€â™‚ï¸', 'ğŸ§â€â™€ï¸', 'ğŸ§Ÿ', 'ğŸ§Ÿâ€â™‚ï¸', 'ğŸ§Ÿâ€â™€ï¸', 'ğŸ§Œ', 'ğŸ’†', 'ğŸ’†â€â™‚ï¸', 'ğŸ’†â€â™€ï¸', 'ğŸ’‡',
        'ğŸ’‡â€â™‚ï¸', 'ğŸ’‡â€â™€ï¸', 'ğŸš¶', 'ğŸš¶â€â™‚ï¸', 'ğŸš¶â€â™€ï¸', 'ğŸ§', 'ğŸ§â€â™‚ï¸', 'ğŸ§â€â™€ï¸', 'ğŸ§', 'ğŸ§â€â™‚ï¸', 'ğŸ§â€â™€ï¸', 'ğŸ¦¯', 'ğŸ¦¼', 'ğŸ¦½', 'ğŸƒ', 'ğŸƒâ€â™‚ï¸', 'ğŸƒâ€â™€ï¸', 'ğŸ’ƒ',
        'ğŸ•º', 'ğŸ•´ï¸', 'ğŸ‘¯', 'ğŸ‘¯â€â™‚ï¸', 'ğŸ‘¯â€â™€ï¸', 'ğŸ§–', 'ğŸ§–â€â™‚ï¸', 'ğŸ§–â€â™€ï¸', 'ğŸ§˜', 'ğŸ§‘â€ğŸ¤â€ğŸ§‘', 'ğŸ‘­', 'ğŸ‘«', 'ğŸ‘¬', 'ğŸ’', 'ğŸ‘©â€â¤ï¸â€ğŸ’‹â€ğŸ‘¨'
    ];

            let emojiHtml = '';
            emojis.forEach(emoji => {
                emojiHtml += `<button class="emoji-button" onclick="addEmojiToInputCode('${emoji}')">${emoji}</button>`;
            });

            Swal.fire({
                title: 'é€‰æ‹©ä¸€ä¸ª Emoji',
                html: `<div style="display: flex; flex-wrap: wrap; gap: 8.4px;">${emojiHtml}</div>`,
                showConfirmButton: false,
                showCancelButton: true,
                cancelButtonText: 'å…³é—­',
            });
        }

        function addEmojiToInputCode(emoji) {
            const input = document.getElementById('message-input-code');
            input.value += emoji;
            Swal.close(); // å…³é—­ Emoji é€‰æ‹©å™¨
        }
    </script>
        <style>
        .emoji-button {
            font-size: 24px;
            background: none;
            border: none;
            cursor: pointer;
            padding: 5px;
        }
    
        .emoji-button:hover {
            background-color: #f0f0f0;
            border-radius: 5px;
        }
    </style>
	<script src="{{ url_for('static', filename='sweetalert2.all.min.js') }}"></script>
<script src="{{ url_for('static', filename='prism.js') }}"></script>

<br><br>
<footer>
    <center>
        <div style="display: inline-flex; align-items: center; font-family: Consolas; color: #000;">
            Using <a href="https://github.com/nr0728/Chat-Room" style="text-decoration: none; margin: 0 5px;"><font color="#8CC269">Chat-Room</font></a>.
            Latest Release: <img src="https://img.shields.io/github/v/release/nr0728/Chat-Room?color=%23FFFF00" style="height: 20px; vertical-align: middle;" />
        </div>
    </center>
</footer>

</body>
</html>
